{{ define "main" }}
  <header class="hero card">
    <div class="hero-copy">
      <span class="kicker">Engineer • Data Scientist • SWE</span>
      <h1>Building reliable data + software systems</h1>
      <p class="lead">{{ .Site.Params.tagline }}</p>
      <div class="cta">
        <a class="btn primary" href="#projects">View Projects</a>
        <a class="btn" href="#contact">Contact</a>
      </div>
    </div>
    <div class="hero-shot">
      <img
        src="https://images.unsplash.com/photo-1517694712202-14dd9538aa97?q=80&w=1200&auto=format&fit=crop"
        alt="workspace"
      />
    </div>
  </header>

  <section id="about">
    <h2>About</h2>
    {{/* Pull the about page (first regular page with .File.Path containing about.md) */}}
    {{ $about := site.GetPage "about" }}
    <div class="muted">
      {{ if $about }}
        {{ with $about.Summary }}{{ . | safeHTML }}{{ end }}
      {{ else }}
        I work across data engineering, ML, and backend development. I like
        type-safe schemas, reproducible analysis, and boring infrastructure.
      {{ end }}
    </div>
    {{ if $about }}
      <div class="cta" style="margin-top:12px;">
        <a class="btn" href="{{ $about.RelPermalink }}">Read more →</a>
      </div>
    {{ end }}
  </section>

  <section id="projects">
    <h2>Projects</h2>
    {{/* Gather project pages (non-draft) */}}
    {{ $all := where site.RegularPages "Section" "projects" }}
    {{/* Filter drafts then sort by Weight ascending (default) */}}
    {{ $filtered := where $all "Draft" false }}
    {{ $projects := sort $filtered "Weight" }}
    {{ if gt (len $projects) 0 }}
      <div class="grid">
        {{ range $projects }}
          <article class="card project">
            <div class="project-card-head">
              <h3 class="project-title">
                <a href="{{ .RelPermalink }}">{{ .Title }}</a>
              </h3>
              {{ with .Params.repo }}
                <a
                  class="repo-link"
                  href="{{ . }}"
                  aria-label="Repository link"
                  rel="noopener"
                  target="_blank"
                >
                  <svg
                    class="icon icon-github"
                    viewBox="0 0 24 24"
                    aria-hidden="true"
                    focusable="false"
                  >
                    <path
                      d="M12 .5C5.65.5.5 5.65.5 12c0 5.1 3.29 9.41 7.86 10.94.58.11.79-.25.79-.56 0-.28-.01-1.02-.02-2-3.2.7-3.88-1.54-3.88-1.54-.53-1.33-1.3-1.68-1.3-1.68-1.06-.72.08-.71.08-.71 1.17.08 1.78 1.2 1.78 1.2 1.04 1.78 2.73 1.26 3.4.96.11-.75.41-1.26.75-1.55-2.55-.29-5.23-1.28-5.23-5.71 0-1.26.45-2.29 1.19-3.09-.12-.29-.52-1.47.11-3.07 0 0 .97-.31 3.18 1.18a11.07 11.07 0 0 1 2.9-.39c.98 0 1.97.13 2.9.39 2.2-1.49 3.17-1.18 3.17-1.18.64 1.6.24 2.78.12 3.07.74.8 1.18 1.83 1.18 3.09 0 4.44-2.69 5.41-5.25 5.7.42.36.8 1.07.8 2.17 0 1.57-.01 2.83-.01 3.22 0 .31.21.68.8.56A10.52 10.52 0 0 0 23.5 12C23.5 5.65 18.35.5 12 .5Z"
                    />
                  </svg>
                </a>
              {{ end }}
            </div>
            {{ with .Params.description }}
              <p class="muted">{{ . | markdownify | plainify }}</p>
            {{ end }}
            {{ with .Params.tags }}
              <div class="tags">
                {{ range . }}<span class="tag">{{ . }}</span>{{ end }}
              </div>
            {{ end }}
          </article>
        {{ end }}
      </div>
    {{ else }}
      <p class="muted">
        No projects published yet. Mark a project page's
        <code>draft</code>
        to
        <code>false</code>
        to show it here.
      </p>
    {{ end }}
  </section>

  <section id="writing">
    <h2>Writing</h2>
    <p class="muted">
      Longer posts live at
      <a href="{{ "posts/" | relURL }}">/posts</a>
      .
    </p>
  </section>

  <section id="contact">
    <h2>Contact</h2>
    <p class="muted">
      Email
      <a href="mailto:{{ .Site.Params.email }}">{{ .Site.Params.email }}</a>
      or say hi on
      <a href="{{ .Site.Params.github }}">GitHub</a>
      .
    </p>
  </section>
{{ end }}
